<!-- extend from base layout -->
{% extends "base.html" %}

{% block content %}

<h1>All media
{% if filter_tag %}
tagged "{{ filter_tag.name }}"
<a href="{{ url_for('index') }}{% if sort %}?sort={{ sort }}{% endif %}">[Clear filter]</a>
{% endif %}
</h1>

<h4>
Sort by:
</h4>

<ul class="nav nav-pills">
  <li 
    {% if sort == "name" %}
        class="active" 
    {% endif %}
  ><a href="{{ url_for('index') }}?sort=name{% if filter_tag %}&tag={{ filter_tag.id }}{% endif %}
  ">Name</a>
  </li>
  <li 
    {% if sort == "dateModified" or not sort %}
        class="active" 
    {% endif %}
  ><a href="{{ url_for('index') }}?sort=dateModified{% if filter_tag %}&tag={{ filter_tag.id }}{% endif %}
  ">Date modified</a>
  </li>
  <li 
    {% if sort == "dateAdded" %}
        class="active"  
    {% endif %}
  ><a href="{{ url_for('index') }}?sort=dateAdded{% if filter_tag %}&tag={{ filter_tag.id }}{% endif %}
  ">Date added</a>
  </li>
</ul>

<hr>

{% if media_list %}
{% for m in media_list %}

<div class="panel panel-default" >
  <div class="panel-heading">
  <div style="float: left; width: 50%;">
  <h4>{{ m.name }}</h4>
  </div>
  <div style="float: right; width: 50px;">
    <a href="
    {{ url_for('increment_episode', media_id = m.id) }}{% if filter_tag %}?tag={{ filter_tag.id }}{% endif %}{% if sort %}&sort={{ sort }}{% endif %}" 
    class="btn btn-info" 
    title="Click to increment episode number">
        <span class="glyphicon glyphicon-plus" aria-hidden="true"/>
    </a>
  </div>
  <div style="float: right; width: 60px;">
    <a href="{{ url_for('media_details', media_id=m.id) }}" 
    class="btn btn-danger" 
    title="Edit media">
        <span class="glyphicon glyphicon-pencil" aria-hidden="true"/>
    </a> 
  </div>
  <br style="clear: left;" />
  </div>
  
  <div class="panel-body">
    <b> Current episode: {{'%.12g' % m.current_episode.episode_number if m.current_episode else 'None'}} </b>

<p> {{ m.notes }} </p>

<div id="tags{{m.id}}" style="clear: both;">
{% for t in m.tags %}
<!--<a href= "{{ url_for ('index')}}?tag={{t.id}}{% if sort %}&sort={{ sort }}{% endif %}"><span class="btn btn-sm btn-default"-->
<!--        style="border-left: 20px solid {{ t.colour }}; border-radius: 20px;">-->
<!--    <b>{{ t.name }}</b></span></a>-->
<a href="{{ url_for ('index')}}?tag={{t.id}}{% if sort %}&sort={{ sort }}{% endif %}"
            class="btn btn-default tag">
        <span class="tagColourElement" style="color: {{ t.colour }};" aria-hidden="true">â—–</span><b>{{ t.name }}</b></a>
{% endfor %}
</div>
  </div>
</div>

{% endfor %}

{% else %}
	<p> No media listed yet...</p>
{% endif %}

{% endblock %}
