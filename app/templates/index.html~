<!-- extend from base layout -->
{% extends "base.html" %}

{% block content %}

<h1>All media
{% if filter_tag %}
tagged "{{ filter_tag.name }}"
<a href="{{ url_for('index') }}">[Clear filters]</a>
{% endif %}
</h1>

{% if media_list %}
{% for m in media_list %}

<div class="panel panel-default">
  <div class="panel-heading">
  <div style="float: left; width: 60%;">
  <h4>{{ m.name }}</h4>
  </div>
  <div style="float: right; width: 50px;">
    <a href="
    {{ url_for('increment_episode', media_id = m.id) }}{% if filter_tag %}?tag={{ filter_tag.id }}{% endif %}" 
    class="btn btn-info" 
    title="Click to increment episode number">
        <span class="glyphicon glyphicon-plus" aria-hidden="true"/>
    </a>
  </div>
  <div style="float: right; width: 60px;">
    <a href="{{ url_for('media_details', media_id=m.id) }}" 
    class="btn btn-danger" 
    title="Edit media">
        <span class="glyphicon glyphicon-pencil" aria-hidden="true"/>
    </a> 
  </div>
  <br style="clear: left;" />
  </div>
  
  <div class="panel-body">
    <b> Current episode: {{'%.12g' % m.current_episode.episode_number if m.current_episode else 'None'}} </b>

<p> {{ m.notes }} </p>

<div id="tags{{m.id}}">
{% for t in m.tags %}
<a href= "{{ url_for ('index')}}?tag={{t.id}}"><span class="btn btn-sm btn-default"
        style="border-left: 20px solid {{ t.colour }}; border-radius: 20px;">
    <b>{{ t.name }}</b></span></a>

{% endfor %}
</div>
  </div>
</div>

{% endfor %}

{% else %}
	<p> No media listed yet...</p>
{% endif %}

<form action="{{ url_for('add_media')}}" method="post" name="addMedia" autocomplete="off">
	{{ mediaForm.hidden_tag() }}
	<h3>Add a new series:</h3>

	<div class="control-group">
        <label class="control-label" for="name">Name:</label>
        <div class="controls">
                {{ mediaForm.name(class="form-control") }}
                {% for error in mediaForm.name.errors %}
                <span class="text-danger">[{{ error }}]</span>
                {% endfor %}
        </div>
        </div>

	<div class="control-group">
        <label class="control-label" for="notes">Notes:</label>
        <div class="controls">
                {{ mediaForm.notes(class="form-control") }}
                {% for error in mediaForm.notes.errors %}
                <span class="text-danger">[{{ error }}]</span>
                {% endfor %}

        </div>
        </div>

	<br/>
	<p><input type="submit" class="btn btn-primary" value="Add new media"></p>

</form>

{% endblock %}
